SELECT ID,
       CAST(TIME_UPDATED as datetime) as UPDATED_TIME,
       ACCOUNT_ID,
       APPROXIMATE_COUNT_LOWER_BOUND,
       APPROXIMATE_COUNT_UPPER_BOUND,
       CUSTOMER_FILE_SOURCE,
       DESCRIPTION,
       IS_VALUE_BASED,
       NAME,
       OPT_OUT_LINK,
       PIXEL_ID,
       RETENTION_DAYS,
       RULE,
       RULE_AGGREGATION,
       SUBTYPE,
       PARSE_JSON(DATA_SOURCE):creation_params::varchar as DATA_SOURCE_CREATION_PARAMS,
       PARSE_JSON(DATA_SOURCE):sub_type::varchar as DATA_SOURCE_SUB_TYPE,
       PARSE_JSON(DATA_SOURCE):type::varchar as DATA_SOURCE_TYPE,
       PARSE_JSON(DELIVERY_STATUS):code::number as DELIVERY_STATUS_CODE,
       PARSE_JSON(DELIVERY_STATUS):description::varchar as DELIVERY_STATUS_DESCRIPTION,
       EXTERNAL_EVENT_SOURCE_ID,
       EXTERNAL_EVENT_SOURCE_AUTOMATIC_MATCHING_FIELDS,
       EXTERNAL_EVENT_SOURCE_CAN_PROXY,
       EXTERNAL_EVENT_SOURCE_CODE,
       EXTERNAL_EVENT_SOURCE_CREATION_TIME,
       EXTERNAL_EVENT_SOURCE_DATA_USE_SETTING,
       EXTERNAL_EVENT_SOURCE_ENABLE_AUTOMATIC_MATCHING,
       EXTERNAL_EVENT_SOURCE_FIRST_PARTY_COOKIE_STATUS,
       EXTERNAL_EVENT_SOURCE_IS_CREATED_BY_BUSINESS,
       EXTERNAL_EVENT_SOURCE_IS_CRM,
       EXTERNAL_EVENT_SOURCE_IS_UNAVAILABLE,
       EXTERNAL_EVENT_SOURCE_LAST_FIRED_TIME,
       EXTERNAL_EVENT_SOURCE_NAME,
       LOOKALIKE_COUNTRY,
       LOOKALIKE_IS_FINANCIAL_SERVICE,
       LOOKALIKE_ORIGIN_EVENT_NAME,
       LOOKALIKE_ORIGIN_EVENT_SOURCE_NAME,
       LOOKALIKE_PRODUCT_SET_NAME,
       CAST(LOOKALIKE_RATIO as float) as LOOKALIKE_RATIO,
       CAST(LOOKALIKE_STARTING_RATIO as float) as LOOKALIKE_STARTING_RATIO,
       LOOKALIKE_TYPE,
       PARSE_JSON(OPERATION_STATUS):code::number as OPERATION_STATUS_CODE,
       PARSE_JSON(OPERATION_STATUS):description::varchar as OPERATION_STATUS_DESCRIPTION,
       CAST(PARSE_JSON(PERMISSION_FOR_ACTIONS):can_edit as boolean) as PERMISSION_FOR_ACTIONS_CAN_EDIT,
       CAST(PARSE_JSON(PERMISSION_FOR_ACTIONS):can_see_insight as boolean) as PERMISSION_FOR_ACTIONS_CAN_SEE_INSIGHT,
       CAST(PARSE_JSON(PERMISSION_FOR_ACTIONS):can_share as boolean) as PERMISSION_FOR_ACTIONS_CAN_SHARE,
       CAST(PARSE_JSON(PERMISSION_FOR_ACTIONS):subtype_supports_lookalike as boolean) as PERMISSION_FOR_ACTIONS_SUBTYPE_SUPPORTS_LOOKALIKE,
       CAST(PARSE_JSON(PERMISSION_FOR_ACTIONS):supports_recipient_lookalike as boolean) as PERMISSION_FOR_ACTIONS_SUPPORTS_RECIPIENT_LOOKALIKE,
       CAST(TIME_CONTENT_UPDATED as datetime) as CONTENT_UPDATED_TIME,
       CAST(TIME_CREATED as datetime) as CREATED_TIME,
       _SDC_BATCHED_AT

FROM {{ source('tap_facebook', 'customaudiences') }} as meltano_custom_audiences